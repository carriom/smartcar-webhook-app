"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/webhook/route";
exports.ids = ["app/api/webhook/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "perf_hooks":
/*!*****************************!*\
  !*** external "perf_hooks" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("perf_hooks");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_maurocarrio_smartcar_smartcar_webhook_app_app_api_webhook_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/webhook/route.ts */ \"(rsc)/./app/api/webhook/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/webhook/route\",\n        pathname: \"/api/webhook\",\n        filename: \"route\",\n        bundlePath: \"app/api/webhook/route\"\n    },\n    resolvedPagePath: \"/Users/maurocarrio/smartcar/smartcar-webhook-app/app/api/webhook/route.ts\",\n    nextConfigOutput,\n    userland: _Users_maurocarrio_smartcar_smartcar_webhook_app_app_api_webhook_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/webhook/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3ZWJob29rJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ3ZWJob29rJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGd2ViaG9vayUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1hdXJvY2FycmlvJTJGc21hcnRjYXIlMkZzbWFydGNhci13ZWJob29rLWFwcCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZtYXVyb2NhcnJpbyUyRnNtYXJ0Y2FyJTJGc21hcnRjYXItd2ViaG9vay1hcHAmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3lCO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hcnRjYXItd2ViaG9vay1hcHAvP2EzMjYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL21hdXJvY2FycmlvL3NtYXJ0Y2FyL3NtYXJ0Y2FyLXdlYmhvb2stYXBwL2FwcC9hcGkvd2ViaG9vay9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2ViaG9vay9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3dlYmhvb2tcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3dlYmhvb2svcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbWF1cm9jYXJyaW8vc21hcnRjYXIvc21hcnRjYXItd2ViaG9vay1hcHAvYXBwL2FwaS93ZWJob29rL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS93ZWJob29rL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/webhook/route.ts":
/*!**********************************!*\
  !*** ./app/api/webhook/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _db_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/db/client */ \"(rsc)/./db/client.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/db/schema */ \"(rsc)/./db/schema.ts\");\n/* harmony import */ var _lib_verifySignature__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/verifySignature */ \"(rsc)/./lib/verifySignature.ts\");\n/* harmony import */ var _lib_flatten__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/flatten */ \"(rsc)/./lib/flatten.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n\n\n\n\n\n\nconst runtime = \"nodejs\";\nasync function POST(req) {\n    const bodyBuffer = Buffer.from(await req.arrayBuffer());\n    const signatureHeader = req.headers.get(\"SC-Signature\");\n    const secret = process.env.SMARTCAR_WEBHOOK_SECRET;\n    if (!secret) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"SMARTCAR_WEBHOOK_SECRET not configured\"\n        }, {\n            status: 500\n        });\n    }\n    const isValid = (0,_lib_verifySignature__WEBPACK_IMPORTED_MODULE_3__.verifySmartcarSignature)({\n        bodyBuffer,\n        signatureHeader,\n        secret\n    });\n    if (!isValid) {\n        // Skip insert if invalid signature\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: false,\n            error: \"invalid signature\"\n        }, {\n            status: 401\n        });\n    }\n    let json;\n    try {\n        json = JSON.parse(bodyBuffer.toString(\"utf8\"));\n    } catch  {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"invalid json\"\n        }, {\n            status: 400\n        });\n    }\n    const eventName = json.eventName;\n    const vehicleId = json.vehicleId;\n    const eventTimestamp = json.timestamp;\n    const data = json.data || {};\n    if (!eventName || !vehicleId || !eventTimestamp) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"missing fields\"\n        }, {\n            status: 400\n        });\n    }\n    // Ensure vehicle exists\n    const existing = await _db_client__WEBPACK_IMPORTED_MODULE_1__.db.select().from(_db_schema__WEBPACK_IMPORTED_MODULE_2__.vehicles).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.vehicles.id, vehicleId)).limit(1);\n    if (existing.length === 0) {\n        await _db_client__WEBPACK_IMPORTED_MODULE_1__.db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.vehicles).values({\n            id: vehicleId\n        }).onConflictDoNothing();\n    }\n    const [eventRow] = await _db_client__WEBPACK_IMPORTED_MODULE_1__.db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.webhookEvents).values({\n        vehicleId,\n        eventName,\n        eventTimestamp: new Date(eventTimestamp),\n        signatureValid: true,\n        rawPayload: json\n    }).returning();\n    const flattened = (0,_lib_flatten__WEBPACK_IMPORTED_MODULE_4__.flattenData)(data);\n    if (flattened.length > 0) {\n        await _db_client__WEBPACK_IMPORTED_MODULE_1__.db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.signals).values(flattened.map((entry)=>({\n                webhookEventId: eventRow.id,\n                vehicleId,\n                signalPath: entry.path,\n                value: typeof entry.value === \"number\" ? String(entry.value) : null,\n                unit: entry.unit\n            })));\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true,\n        id: eventRow.id\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQztRQUFFSSxJQUFJO1FBQU1ZLElBQUlNLFNBQVNOLEVBQUU7SUFBQztBQUN2RCIsInNvdXJjZXMiOlsid2VicGFjazovL3NtYXJ0Y2FyLXdlYmhvb2stYXBwLy4vYXBwL2FwaS93ZWJob29rL3JvdXRlLnRzPzIxODIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgZGIgfSBmcm9tICdAL2RiL2NsaWVudCdcbmltcG9ydCB7IHZlaGljbGVzLCB3ZWJob29rRXZlbnRzLCBzaWduYWxzIH0gZnJvbSAnQC9kYi9zY2hlbWEnXG5pbXBvcnQgeyB2ZXJpZnlTbWFydGNhclNpZ25hdHVyZSB9IGZyb20gJ0AvbGliL3ZlcmlmeVNpZ25hdHVyZSdcbmltcG9ydCB7IGZsYXR0ZW5EYXRhIH0gZnJvbSAnQC9saWIvZmxhdHRlbidcbmltcG9ydCB7IGVxIH0gZnJvbSAnZHJpenpsZS1vcm0nXG5cbmV4cG9ydCBjb25zdCBydW50aW1lID0gJ25vZGVqcydcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCBib2R5QnVmZmVyID0gQnVmZmVyLmZyb20oYXdhaXQgcmVxLmFycmF5QnVmZmVyKCkpXG4gIGNvbnN0IHNpZ25hdHVyZUhlYWRlciA9IHJlcS5oZWFkZXJzLmdldCgnU0MtU2lnbmF0dXJlJylcbiAgY29uc3Qgc2VjcmV0ID0gcHJvY2Vzcy5lbnYuU01BUlRDQVJfV0VCSE9PS19TRUNSRVRcblxuICBpZiAoIXNlY3JldCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnU01BUlRDQVJfV0VCSE9PS19TRUNSRVQgbm90IGNvbmZpZ3VyZWQnIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxuXG4gIGNvbnN0IGlzVmFsaWQgPSB2ZXJpZnlTbWFydGNhclNpZ25hdHVyZSh7IGJvZHlCdWZmZXIsIHNpZ25hdHVyZUhlYWRlciwgc2VjcmV0IH0pXG4gIGlmICghaXNWYWxpZCkge1xuICAgIC8vIFNraXAgaW5zZXJ0IGlmIGludmFsaWQgc2lnbmF0dXJlXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogJ2ludmFsaWQgc2lnbmF0dXJlJyB9LCB7IHN0YXR1czogNDAxIH0pXG4gIH1cblxuICBsZXQganNvbjogYW55XG4gIHRyeSB7XG4gICAganNvbiA9IEpTT04ucGFyc2UoYm9keUJ1ZmZlci50b1N0cmluZygndXRmOCcpKVxuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ2ludmFsaWQganNvbicgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICB9XG5cbiAgY29uc3QgZXZlbnROYW1lOiBzdHJpbmcgPSBqc29uLmV2ZW50TmFtZVxuICBjb25zdCB2ZWhpY2xlSWQ6IHN0cmluZyA9IGpzb24udmVoaWNsZUlkXG4gIGNvbnN0IGV2ZW50VGltZXN0YW1wOiBzdHJpbmcgPSBqc29uLnRpbWVzdGFtcFxuICBjb25zdCBkYXRhOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IGpzb24uZGF0YSB8fCB7fVxuXG4gIGlmICghZXZlbnROYW1lIHx8ICF2ZWhpY2xlSWQgfHwgIWV2ZW50VGltZXN0YW1wKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdtaXNzaW5nIGZpZWxkcycgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICB9XG5cbiAgLy8gRW5zdXJlIHZlaGljbGUgZXhpc3RzXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh2ZWhpY2xlcykud2hlcmUoZXEodmVoaWNsZXMuaWQsIHZlaGljbGVJZCkpLmxpbWl0KDEpXG4gIGlmIChleGlzdGluZy5sZW5ndGggPT09IDApIHtcbiAgICBhd2FpdCBkYi5pbnNlcnQodmVoaWNsZXMpLnZhbHVlcyh7IGlkOiB2ZWhpY2xlSWQgfSkub25Db25mbGljdERvTm90aGluZygpXG4gIH1cblxuICBjb25zdCBbZXZlbnRSb3ddID0gYXdhaXQgZGJcbiAgICAuaW5zZXJ0KHdlYmhvb2tFdmVudHMpXG4gICAgLnZhbHVlcyh7XG4gICAgICB2ZWhpY2xlSWQsXG4gICAgICBldmVudE5hbWUsXG4gICAgICBldmVudFRpbWVzdGFtcDogbmV3IERhdGUoZXZlbnRUaW1lc3RhbXApLFxuICAgICAgc2lnbmF0dXJlVmFsaWQ6IHRydWUsXG4gICAgICByYXdQYXlsb2FkOiBqc29uLFxuICAgIH0pXG4gICAgLnJldHVybmluZygpXG5cbiAgY29uc3QgZmxhdHRlbmVkID0gZmxhdHRlbkRhdGEoZGF0YSlcblxuICBpZiAoZmxhdHRlbmVkLmxlbmd0aCA+IDApIHtcbiAgICBhd2FpdCBkYi5pbnNlcnQoc2lnbmFscykudmFsdWVzKFxuICAgICAgZmxhdHRlbmVkLm1hcCgoZW50cnkpID0+ICh7XG4gICAgICAgIHdlYmhvb2tFdmVudElkOiBldmVudFJvdy5pZCxcbiAgICAgICAgdmVoaWNsZUlkLFxuICAgICAgICBzaWduYWxQYXRoOiBlbnRyeS5wYXRoLFxuICAgICAgICB2YWx1ZTogdHlwZW9mIGVudHJ5LnZhbHVlID09PSAnbnVtYmVyJyA/IFN0cmluZyhlbnRyeS52YWx1ZSkgOiBudWxsLFxuICAgICAgICB1bml0OiBlbnRyeS51bml0LFxuICAgICAgfSkpXG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IHRydWUsIGlkOiBldmVudFJvdy5pZCB9KVxufVxuXG5cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJkYiIsInZlaGljbGVzIiwid2ViaG9va0V2ZW50cyIsInNpZ25hbHMiLCJ2ZXJpZnlTbWFydGNhclNpZ25hdHVyZSIsImZsYXR0ZW5EYXRhIiwiZXEiLCJydW50aW1lIiwiUE9TVCIsInJlcSIsImJvZHlCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiYXJyYXlCdWZmZXIiLCJzaWduYXR1cmVIZWFkZXIiLCJoZWFkZXJzIiwiZ2V0Iiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIlNNQVJUQ0FSX1dFQkhPT0tfU0VDUkVUIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiaXNWYWxpZCIsIm9rIiwiSlNPTiIsInBhcnNlIiwidG9TdHJpbmciLCJldmVudE5hbWUiLCJ2ZWhpY2xlSWQiLCJldmVudFRpbWVzdGFtcCIsInRpbWVzdGFtcCIsImRhdGEiLCJleGlzdGluZyIsInNlbGVjdCIsIndoZXJlIiwiaWQiLCJsaW1pdCIsImxlbmd0aCIsImluc2VydCIsInZhbHVlcyIsIm9uQ29uZmxpY3REb05vdGhpbmciLCJldmVudFJvdyIsIkRhdGUiLCJzaWduYXR1cmVWYWxpZCIsInJhd1BheWxvYWQiLCJyZXR1cm5pbmciLCJmbGF0dGVuZWQiLCJtYXAiLCJlbnRyeSIsIndlYmhvb2tFdmVudElkIiwic2lnbmFsUGF0aCIsInBhdGgiLCJ2YWx1ZSIsIlN0cmluZyIsInVuaXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/webhook/route.ts\n");

/***/ }),

/***/ "(rsc)/./db/client.ts":
/*!**********************!*\
  !*** ./db/client.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db)\n/* harmony export */ });\n/* harmony import */ var _schema__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./schema */ \"(rsc)/./db/schema.ts\");\n\nlet dbImpl;\nif (process.env.POSTGRES_URL) {\n    // Vercel Postgres\n    const { drizzle } = __webpack_require__(/*! drizzle-orm/vercel-postgres */ \"(rsc)/./node_modules/drizzle-orm/vercel-postgres/index.cjs\");\n    const { sql } = __webpack_require__(/*! @vercel/postgres */ \"(rsc)/./node_modules/@vercel/postgres/dist/index-node.cjs\");\n    dbImpl = drizzle(sql, {\n        schema: _schema__WEBPACK_IMPORTED_MODULE_0__\n    });\n} else if (process.env.DATABASE_URL) {\n    // Generic Postgres (e.g., Supabase) via postgres-js\n    const { drizzle } = __webpack_require__(/*! drizzle-orm/postgres-js */ \"(rsc)/./node_modules/drizzle-orm/postgres-js/index.cjs\");\n    const postgres = __webpack_require__(/*! postgres */ \"(rsc)/./node_modules/postgres/cjs/src/index.js\");\n    const client = postgres(process.env.DATABASE_URL, {\n        max: 1,\n        prepare: false\n    });\n    dbImpl = drizzle(client, {\n        schema: _schema__WEBPACK_IMPORTED_MODULE_0__\n    });\n} else {\n    throw new Error(\"Missing POSTGRES_URL (Vercel Postgres) or DATABASE_URL (generic Postgres)\");\n}\nconst db = dbImpl;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYi9jbGllbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBa0M7QUFFbEMsSUFBSUM7QUFFSixJQUFJQyxRQUFRQyxHQUFHLENBQUNDLFlBQVksRUFBRTtJQUM1QixrQkFBa0I7SUFDbEIsTUFBTSxFQUFFQyxPQUFPLEVBQUUsR0FBR0MsbUJBQU9BLENBQUM7SUFDNUIsTUFBTSxFQUFFQyxHQUFHLEVBQUUsR0FBR0QsbUJBQU9BLENBQUM7SUFDeEJMLFNBQVNJLFFBQVFFLEtBQUs7UUFBRVAsTUFBTUEsc0NBQUFBO0lBQUM7QUFDakMsT0FBTyxJQUFJRSxRQUFRQyxHQUFHLENBQUNLLFlBQVksRUFBRTtJQUNuQyxvREFBb0Q7SUFDcEQsTUFBTSxFQUFFSCxPQUFPLEVBQUUsR0FBR0MsbUJBQU9BLENBQUM7SUFDNUIsTUFBTUcsV0FBV0gsbUJBQU9BLENBQUM7SUFDekIsTUFBTUksU0FBU0QsU0FBU1AsUUFBUUMsR0FBRyxDQUFDSyxZQUFZLEVBQUc7UUFBRUcsS0FBSztRQUFHQyxTQUFTO0lBQU07SUFDNUVYLFNBQVNJLFFBQVFLLFFBQVE7UUFBRVYsTUFBTUEsc0NBQUFBO0lBQUM7QUFDcEMsT0FBTztJQUNMLE1BQU0sSUFBSWEsTUFBTTtBQUNsQjtBQUVPLE1BQU1DLEtBQUtiLE9BQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbWFydGNhci13ZWJob29rLWFwcC8uL2RiL2NsaWVudC50cz9jMmRlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHNjaGVtYSBmcm9tICcuL3NjaGVtYSdcblxubGV0IGRiSW1wbDogUmV0dXJuVHlwZTxhbnk+XG5cbmlmIChwcm9jZXNzLmVudi5QT1NUR1JFU19VUkwpIHtcbiAgLy8gVmVyY2VsIFBvc3RncmVzXG4gIGNvbnN0IHsgZHJpenpsZSB9ID0gcmVxdWlyZSgnZHJpenpsZS1vcm0vdmVyY2VsLXBvc3RncmVzJykgYXMgdHlwZW9mIGltcG9ydCgnZHJpenpsZS1vcm0vdmVyY2VsLXBvc3RncmVzJylcbiAgY29uc3QgeyBzcWwgfSA9IHJlcXVpcmUoJ0B2ZXJjZWwvcG9zdGdyZXMnKSBhcyB0eXBlb2YgaW1wb3J0KCdAdmVyY2VsL3Bvc3RncmVzJylcbiAgZGJJbXBsID0gZHJpenpsZShzcWwsIHsgc2NoZW1hIH0pXG59IGVsc2UgaWYgKHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCkge1xuICAvLyBHZW5lcmljIFBvc3RncmVzIChlLmcuLCBTdXBhYmFzZSkgdmlhIHBvc3RncmVzLWpzXG4gIGNvbnN0IHsgZHJpenpsZSB9ID0gcmVxdWlyZSgnZHJpenpsZS1vcm0vcG9zdGdyZXMtanMnKSBhcyB0eXBlb2YgaW1wb3J0KCdkcml6emxlLW9ybS9wb3N0Z3Jlcy1qcycpXG4gIGNvbnN0IHBvc3RncmVzID0gcmVxdWlyZSgncG9zdGdyZXMnKSBhcyB0eXBlb2YgaW1wb3J0KCdwb3N0Z3JlcycpXG4gIGNvbnN0IGNsaWVudCA9IHBvc3RncmVzKHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCEsIHsgbWF4OiAxLCBwcmVwYXJlOiBmYWxzZSB9KVxuICBkYkltcGwgPSBkcml6emxlKGNsaWVudCwgeyBzY2hlbWEgfSlcbn0gZWxzZSB7XG4gIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBQT1NUR1JFU19VUkwgKFZlcmNlbCBQb3N0Z3Jlcykgb3IgREFUQUJBU0VfVVJMIChnZW5lcmljIFBvc3RncmVzKScpXG59XG5cbmV4cG9ydCBjb25zdCBkYiA9IGRiSW1wbFxuXG5cbiJdLCJuYW1lcyI6WyJzY2hlbWEiLCJkYkltcGwiLCJwcm9jZXNzIiwiZW52IiwiUE9TVEdSRVNfVVJMIiwiZHJpenpsZSIsInJlcXVpcmUiLCJzcWwiLCJEQVRBQkFTRV9VUkwiLCJwb3N0Z3JlcyIsImNsaWVudCIsIm1heCIsInByZXBhcmUiLCJFcnJvciIsImRiIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./db/client.ts\n");

/***/ }),

/***/ "(rsc)/./db/schema.ts":
/*!**********************!*\
  !*** ./db/schema.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   signals: () => (/* binding */ signals),\n/* harmony export */   signalsRelations: () => (/* binding */ signalsRelations),\n/* harmony export */   vehicles: () => (/* binding */ vehicles),\n/* harmony export */   vehiclesRelations: () => (/* binding */ vehiclesRelations),\n/* harmony export */   webhookEvents: () => (/* binding */ webhookEvents),\n/* harmony export */   webhookEventsRelations: () => (/* binding */ webhookEventsRelations)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/table.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/text.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/integer.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/timestamp.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/uuid.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/boolean.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/jsonb.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/drizzle-orm/pg-core/columns/numeric.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/relations.js\");\n\n\nconst vehicles = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"vehicles\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"id\").primaryKey(),\n    make: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"make\"),\n    model: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"model\"),\n    year: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.integer)(\"year\"),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"created_at\", {\n        withTimezone: true\n    }).defaultNow()\n});\nconst webhookEvents = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"webhook_events\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.uuid)(\"id\").primaryKey().defaultRandom(),\n    vehicleId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"vehicle_id\").references(()=>vehicles.id),\n    eventName: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"event_name\").notNull(),\n    eventTimestamp: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"event_timestamp\", {\n        withTimezone: true\n    }).notNull(),\n    receivedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"received_at\", {\n        withTimezone: true\n    }).defaultNow(),\n    signatureValid: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.boolean)(\"signature_valid\"),\n    rawPayload: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.jsonb)(\"raw_payload\").notNull()\n});\nconst signals = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"signals\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.uuid)(\"id\").primaryKey().defaultRandom(),\n    webhookEventId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.uuid)(\"webhook_event_id\").references(()=>webhookEvents.id),\n    vehicleId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"vehicle_id\"),\n    signalPath: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"signal_path\"),\n    value: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.numeric)(\"value\"),\n    unit: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.text)(\"unit\"),\n    recordedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"recorded_at\", {\n        withTimezone: true\n    }).defaultNow()\n});\nconst vehiclesRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.relations)(vehicles, ({ many })=>({\n        events: many(webhookEvents)\n    }));\nconst webhookEventsRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.relations)(webhookEvents, ({ one, many })=>({\n        vehicle: one(vehicles, {\n            fields: [\n                webhookEvents.vehicleId\n            ],\n            references: [\n                vehicles.id\n            ]\n        }),\n        signals: many(signals)\n    }));\nconst signalsRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.relations)(signals, ({ one })=>({\n        event: one(webhookEvents, {\n            fields: [\n                signals.webhookEventId\n            ],\n            references: [\n                webhookEvents.id\n            ]\n        })\n    }));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYi9zY2hlbWEudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQy9EO0FBRWhDLE1BQU1TLFdBQVdULDREQUFPQSxDQUFDLFlBQVk7SUFDMUNVLElBQUlULHlEQUFJQSxDQUFDLE1BQU1VLFVBQVU7SUFDekJDLE1BQU1YLHlEQUFJQSxDQUFDO0lBQ1hZLE9BQU9aLHlEQUFJQSxDQUFDO0lBQ1phLE1BQU1aLDREQUFPQSxDQUFDO0lBQ2RhLFdBQVdaLDhEQUFTQSxDQUFDLGNBQWM7UUFBRWEsY0FBYztJQUFLLEdBQUdDLFVBQVU7QUFDdkUsR0FBRTtBQUVLLE1BQU1DLGdCQUFnQmxCLDREQUFPQSxDQUFDLGtCQUFrQjtJQUNyRFUsSUFBSUwseURBQUlBLENBQUMsTUFBTU0sVUFBVSxHQUFHUSxhQUFhO0lBQ3pDQyxXQUFXbkIseURBQUlBLENBQUMsY0FBY29CLFVBQVUsQ0FBQyxJQUFNWixTQUFTQyxFQUFFO0lBQzFEWSxXQUFXckIseURBQUlBLENBQUMsY0FBY3NCLE9BQU87SUFDckNDLGdCQUFnQnJCLDhEQUFTQSxDQUFDLG1CQUFtQjtRQUFFYSxjQUFjO0lBQUssR0FBR08sT0FBTztJQUM1RUUsWUFBWXRCLDhEQUFTQSxDQUFDLGVBQWU7UUFBRWEsY0FBYztJQUFLLEdBQUdDLFVBQVU7SUFDdkVTLGdCQUFnQnBCLDREQUFPQSxDQUFDO0lBQ3hCcUIsWUFBWXZCLDBEQUFLQSxDQUFDLGVBQWVtQixPQUFPO0FBQzFDLEdBQUU7QUFFSyxNQUFNSyxVQUFVNUIsNERBQU9BLENBQUMsV0FBVztJQUN4Q1UsSUFBSUwseURBQUlBLENBQUMsTUFBTU0sVUFBVSxHQUFHUSxhQUFhO0lBQ3pDVSxnQkFBZ0J4Qix5REFBSUEsQ0FBQyxvQkFBb0JnQixVQUFVLENBQUMsSUFBTUgsY0FBY1IsRUFBRTtJQUMxRVUsV0FBV25CLHlEQUFJQSxDQUFDO0lBQ2hCNkIsWUFBWTdCLHlEQUFJQSxDQUFDO0lBQ2pCOEIsT0FBT3hCLDREQUFPQSxDQUFDO0lBQ2Z5QixNQUFNL0IseURBQUlBLENBQUM7SUFDWGdDLFlBQVk5Qiw4REFBU0EsQ0FBQyxlQUFlO1FBQUVhLGNBQWM7SUFBSyxHQUFHQyxVQUFVO0FBQ3pFLEdBQUU7QUFFSyxNQUFNaUIsb0JBQW9CMUIsc0RBQVNBLENBQUNDLFVBQVUsQ0FBQyxFQUFFMEIsSUFBSSxFQUFFLEdBQU07UUFDbEVDLFFBQVFELEtBQUtqQjtJQUNmLElBQUc7QUFFSSxNQUFNbUIseUJBQXlCN0Isc0RBQVNBLENBQUNVLGVBQWUsQ0FBQyxFQUFFb0IsR0FBRyxFQUFFSCxJQUFJLEVBQUUsR0FBTTtRQUNqRkksU0FBU0QsSUFBSTdCLFVBQVU7WUFDckIrQixRQUFRO2dCQUFDdEIsY0FBY0UsU0FBUzthQUFDO1lBQ2pDQyxZQUFZO2dCQUFDWixTQUFTQyxFQUFFO2FBQUM7UUFDM0I7UUFDQWtCLFNBQVNPLEtBQUtQO0lBQ2hCLElBQUc7QUFFSSxNQUFNYSxtQkFBbUJqQyxzREFBU0EsQ0FBQ29CLFNBQVMsQ0FBQyxFQUFFVSxHQUFHLEVBQUUsR0FBTTtRQUMvREksT0FBT0osSUFBSXBCLGVBQWU7WUFDeEJzQixRQUFRO2dCQUFDWixRQUFRQyxjQUFjO2FBQUM7WUFDaENSLFlBQVk7Z0JBQUNILGNBQWNSLEVBQUU7YUFBQztRQUNoQztJQUNGLElBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbWFydGNhci13ZWJob29rLWFwcC8uL2RiL3NjaGVtYS50cz8xYTI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBnVGFibGUsIHRleHQsIGludGVnZXIsIHRpbWVzdGFtcCwganNvbmIsIHV1aWQsIGJvb2xlYW4sIG51bWVyaWMgfSBmcm9tICdkcml6emxlLW9ybS9wZy1jb3JlJ1xuaW1wb3J0IHsgcmVsYXRpb25zIH0gZnJvbSAnZHJpenpsZS1vcm0nXG5cbmV4cG9ydCBjb25zdCB2ZWhpY2xlcyA9IHBnVGFibGUoJ3ZlaGljbGVzJywge1xuICBpZDogdGV4dCgnaWQnKS5wcmltYXJ5S2V5KCksXG4gIG1ha2U6IHRleHQoJ21ha2UnKSxcbiAgbW9kZWw6IHRleHQoJ21vZGVsJyksXG4gIHllYXI6IGludGVnZXIoJ3llYXInKSxcbiAgY3JlYXRlZEF0OiB0aW1lc3RhbXAoJ2NyZWF0ZWRfYXQnLCB7IHdpdGhUaW1lem9uZTogdHJ1ZSB9KS5kZWZhdWx0Tm93KCksXG59KVxuXG5leHBvcnQgY29uc3Qgd2ViaG9va0V2ZW50cyA9IHBnVGFibGUoJ3dlYmhvb2tfZXZlbnRzJywge1xuICBpZDogdXVpZCgnaWQnKS5wcmltYXJ5S2V5KCkuZGVmYXVsdFJhbmRvbSgpLFxuICB2ZWhpY2xlSWQ6IHRleHQoJ3ZlaGljbGVfaWQnKS5yZWZlcmVuY2VzKCgpID0+IHZlaGljbGVzLmlkKSxcbiAgZXZlbnROYW1lOiB0ZXh0KCdldmVudF9uYW1lJykubm90TnVsbCgpLFxuICBldmVudFRpbWVzdGFtcDogdGltZXN0YW1wKCdldmVudF90aW1lc3RhbXAnLCB7IHdpdGhUaW1lem9uZTogdHJ1ZSB9KS5ub3ROdWxsKCksXG4gIHJlY2VpdmVkQXQ6IHRpbWVzdGFtcCgncmVjZWl2ZWRfYXQnLCB7IHdpdGhUaW1lem9uZTogdHJ1ZSB9KS5kZWZhdWx0Tm93KCksXG4gIHNpZ25hdHVyZVZhbGlkOiBib29sZWFuKCdzaWduYXR1cmVfdmFsaWQnKSxcbiAgcmF3UGF5bG9hZDoganNvbmIoJ3Jhd19wYXlsb2FkJykubm90TnVsbCgpLFxufSlcblxuZXhwb3J0IGNvbnN0IHNpZ25hbHMgPSBwZ1RhYmxlKCdzaWduYWxzJywge1xuICBpZDogdXVpZCgnaWQnKS5wcmltYXJ5S2V5KCkuZGVmYXVsdFJhbmRvbSgpLFxuICB3ZWJob29rRXZlbnRJZDogdXVpZCgnd2ViaG9va19ldmVudF9pZCcpLnJlZmVyZW5jZXMoKCkgPT4gd2ViaG9va0V2ZW50cy5pZCksXG4gIHZlaGljbGVJZDogdGV4dCgndmVoaWNsZV9pZCcpLFxuICBzaWduYWxQYXRoOiB0ZXh0KCdzaWduYWxfcGF0aCcpLFxuICB2YWx1ZTogbnVtZXJpYygndmFsdWUnKSxcbiAgdW5pdDogdGV4dCgndW5pdCcpLFxuICByZWNvcmRlZEF0OiB0aW1lc3RhbXAoJ3JlY29yZGVkX2F0JywgeyB3aXRoVGltZXpvbmU6IHRydWUgfSkuZGVmYXVsdE5vdygpLFxufSlcblxuZXhwb3J0IGNvbnN0IHZlaGljbGVzUmVsYXRpb25zID0gcmVsYXRpb25zKHZlaGljbGVzLCAoeyBtYW55IH0pID0+ICh7XG4gIGV2ZW50czogbWFueSh3ZWJob29rRXZlbnRzKSxcbn0pKVxuXG5leHBvcnQgY29uc3Qgd2ViaG9va0V2ZW50c1JlbGF0aW9ucyA9IHJlbGF0aW9ucyh3ZWJob29rRXZlbnRzLCAoeyBvbmUsIG1hbnkgfSkgPT4gKHtcbiAgdmVoaWNsZTogb25lKHZlaGljbGVzLCB7XG4gICAgZmllbGRzOiBbd2ViaG9va0V2ZW50cy52ZWhpY2xlSWRdLFxuICAgIHJlZmVyZW5jZXM6IFt2ZWhpY2xlcy5pZF0sXG4gIH0pLFxuICBzaWduYWxzOiBtYW55KHNpZ25hbHMpLFxufSkpXG5cbmV4cG9ydCBjb25zdCBzaWduYWxzUmVsYXRpb25zID0gcmVsYXRpb25zKHNpZ25hbHMsICh7IG9uZSB9KSA9PiAoe1xuICBldmVudDogb25lKHdlYmhvb2tFdmVudHMsIHtcbiAgICBmaWVsZHM6IFtzaWduYWxzLndlYmhvb2tFdmVudElkXSxcbiAgICByZWZlcmVuY2VzOiBbd2ViaG9va0V2ZW50cy5pZF0sXG4gIH0pLFxufSkpXG5cblxuIl0sIm5hbWVzIjpbInBnVGFibGUiLCJ0ZXh0IiwiaW50ZWdlciIsInRpbWVzdGFtcCIsImpzb25iIiwidXVpZCIsImJvb2xlYW4iLCJudW1lcmljIiwicmVsYXRpb25zIiwidmVoaWNsZXMiLCJpZCIsInByaW1hcnlLZXkiLCJtYWtlIiwibW9kZWwiLCJ5ZWFyIiwiY3JlYXRlZEF0Iiwid2l0aFRpbWV6b25lIiwiZGVmYXVsdE5vdyIsIndlYmhvb2tFdmVudHMiLCJkZWZhdWx0UmFuZG9tIiwidmVoaWNsZUlkIiwicmVmZXJlbmNlcyIsImV2ZW50TmFtZSIsIm5vdE51bGwiLCJldmVudFRpbWVzdGFtcCIsInJlY2VpdmVkQXQiLCJzaWduYXR1cmVWYWxpZCIsInJhd1BheWxvYWQiLCJzaWduYWxzIiwid2ViaG9va0V2ZW50SWQiLCJzaWduYWxQYXRoIiwidmFsdWUiLCJ1bml0IiwicmVjb3JkZWRBdCIsInZlaGljbGVzUmVsYXRpb25zIiwibWFueSIsImV2ZW50cyIsIndlYmhvb2tFdmVudHNSZWxhdGlvbnMiLCJvbmUiLCJ2ZWhpY2xlIiwiZmllbGRzIiwic2lnbmFsc1JlbGF0aW9ucyIsImV2ZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./db/schema.ts\n");

/***/ }),

/***/ "(rsc)/./lib/flatten.ts":
/*!************************!*\
  !*** ./lib/flatten.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   flattenData: () => (/* binding */ flattenData)\n/* harmony export */ });\nfunction flattenData(data, parentKey = []) {\n    const entries = [];\n    for (const [key, value] of Object.entries(data)){\n        const nextKeys = [\n            ...parentKey,\n            key\n        ];\n        if (value !== null && typeof value === \"object\" && !Array.isArray(value)) {\n            // Special-case common unit fields next to values\n            const nested = value;\n            const unit = typeof nested.unit === \"string\" ? nested.unit : undefined;\n            for (const [childKey, childValue] of Object.entries(nested)){\n                if (childKey === \"unit\") continue;\n                const path = [\n                    ...nextKeys,\n                    childKey\n                ].join(\".\");\n                if (typeof childValue === \"number\" || typeof childValue === \"string\" || typeof childValue === \"boolean\" || childValue === null) {\n                    entries.push({\n                        path,\n                        value: childValue,\n                        unit\n                    });\n                } else if (childValue && typeof childValue === \"object\") {\n                    entries.push(...flattenData({\n                        [childKey]: childValue\n                    }, nextKeys));\n                }\n            }\n        } else if (typeof value === \"number\" || typeof value === \"string\" || typeof value === \"boolean\" || value === null) {\n            entries.push({\n                path: nextKeys.join(\".\"),\n                value: value\n            });\n        }\n    }\n    return entries;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZmxhdHRlbi50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRU8sU0FBU0EsWUFDZEMsSUFBNkIsRUFDN0JDLFlBQXNCLEVBQUU7SUFFeEIsTUFBTUMsVUFBNEIsRUFBRTtJQUVwQyxLQUFLLE1BQU0sQ0FBQ0MsS0FBS0MsTUFBTSxJQUFJQyxPQUFPSCxPQUFPLENBQUNGLE1BQU87UUFDL0MsTUFBTU0sV0FBVztlQUFJTDtZQUFXRTtTQUFJO1FBRXBDLElBQUlDLFVBQVUsUUFBUSxPQUFPQSxVQUFVLFlBQVksQ0FBQ0csTUFBTUMsT0FBTyxDQUFDSixRQUFRO1lBQ3hFLGlEQUFpRDtZQUNqRCxNQUFNSyxTQUFTTDtZQUNmLE1BQU1NLE9BQU8sT0FBT0QsT0FBT0MsSUFBSSxLQUFLLFdBQVlELE9BQU9DLElBQUksR0FBY0M7WUFFekUsS0FBSyxNQUFNLENBQUNDLFVBQVVDLFdBQVcsSUFBSVIsT0FBT0gsT0FBTyxDQUFDTyxRQUFTO2dCQUMzRCxJQUFJRyxhQUFhLFFBQVE7Z0JBQ3pCLE1BQU1FLE9BQU87dUJBQUlSO29CQUFVTTtpQkFBUyxDQUFDRyxJQUFJLENBQUM7Z0JBQzFDLElBQUksT0FBT0YsZUFBZSxZQUFZLE9BQU9BLGVBQWUsWUFBWSxPQUFPQSxlQUFlLGFBQWFBLGVBQWUsTUFBTTtvQkFDOUhYLFFBQVFjLElBQUksQ0FBQzt3QkFBRUY7d0JBQU1WLE9BQU9TO3dCQUFtQkg7b0JBQUs7Z0JBQ3RELE9BQU8sSUFBSUcsY0FBYyxPQUFPQSxlQUFlLFVBQVU7b0JBQ3ZEWCxRQUFRYyxJQUFJLElBQUlqQixZQUFZO3dCQUFFLENBQUNhLFNBQVMsRUFBRUM7b0JBQWtCLEdBQUdQO2dCQUNqRTtZQUNGO1FBQ0YsT0FBTyxJQUFJLE9BQU9GLFVBQVUsWUFBWSxPQUFPQSxVQUFVLFlBQVksT0FBT0EsVUFBVSxhQUFhQSxVQUFVLE1BQU07WUFDakhGLFFBQVFjLElBQUksQ0FBQztnQkFBRUYsTUFBTVIsU0FBU1MsSUFBSSxDQUFDO2dCQUFNWCxPQUFPQTtZQUFhO1FBQy9EO0lBQ0Y7SUFFQSxPQUFPRjtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc21hcnRjYXItd2ViaG9vay1hcHAvLi9saWIvZmxhdHRlbi50cz9hY2MxIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIEZsYXR0ZW5lZEVudHJ5ID0geyBwYXRoOiBzdHJpbmc7IHZhbHVlOiBudW1iZXIgfCBzdHJpbmcgfCBib29sZWFuIHwgbnVsbDsgdW5pdD86IHN0cmluZyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBmbGF0dGVuRGF0YShcbiAgZGF0YTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sXG4gIHBhcmVudEtleTogc3RyaW5nW10gPSBbXVxuKTogRmxhdHRlbmVkRW50cnlbXSB7XG4gIGNvbnN0IGVudHJpZXM6IEZsYXR0ZW5lZEVudHJ5W10gPSBbXVxuXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEpKSB7XG4gICAgY29uc3QgbmV4dEtleXMgPSBbLi4ucGFyZW50S2V5LCBrZXldXG5cbiAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIC8vIFNwZWNpYWwtY2FzZSBjb21tb24gdW5pdCBmaWVsZHMgbmV4dCB0byB2YWx1ZXNcbiAgICAgIGNvbnN0IG5lc3RlZCA9IHZhbHVlIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+XG4gICAgICBjb25zdCB1bml0ID0gdHlwZW9mIG5lc3RlZC51bml0ID09PSAnc3RyaW5nJyA/IChuZXN0ZWQudW5pdCBhcyBzdHJpbmcpIDogdW5kZWZpbmVkXG5cbiAgICAgIGZvciAoY29uc3QgW2NoaWxkS2V5LCBjaGlsZFZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhuZXN0ZWQpKSB7XG4gICAgICAgIGlmIChjaGlsZEtleSA9PT0gJ3VuaXQnKSBjb250aW51ZVxuICAgICAgICBjb25zdCBwYXRoID0gWy4uLm5leHRLZXlzLCBjaGlsZEtleV0uam9pbignLicpXG4gICAgICAgIGlmICh0eXBlb2YgY2hpbGRWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGNoaWxkVmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBjaGlsZFZhbHVlID09PSAnYm9vbGVhbicgfHwgY2hpbGRWYWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgIGVudHJpZXMucHVzaCh7IHBhdGgsIHZhbHVlOiBjaGlsZFZhbHVlIGFzIGFueSwgdW5pdCB9KVxuICAgICAgICB9IGVsc2UgaWYgKGNoaWxkVmFsdWUgJiYgdHlwZW9mIGNoaWxkVmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgZW50cmllcy5wdXNoKC4uLmZsYXR0ZW5EYXRhKHsgW2NoaWxkS2V5XTogY2hpbGRWYWx1ZSBhcyBhbnkgfSwgbmV4dEtleXMpKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicgfHwgdmFsdWUgPT09IG51bGwpIHtcbiAgICAgIGVudHJpZXMucHVzaCh7IHBhdGg6IG5leHRLZXlzLmpvaW4oJy4nKSwgdmFsdWU6IHZhbHVlIGFzIGFueSB9KVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBlbnRyaWVzXG59XG5cblxuIl0sIm5hbWVzIjpbImZsYXR0ZW5EYXRhIiwiZGF0YSIsInBhcmVudEtleSIsImVudHJpZXMiLCJrZXkiLCJ2YWx1ZSIsIk9iamVjdCIsIm5leHRLZXlzIiwiQXJyYXkiLCJpc0FycmF5IiwibmVzdGVkIiwidW5pdCIsInVuZGVmaW5lZCIsImNoaWxkS2V5IiwiY2hpbGRWYWx1ZSIsInBhdGgiLCJqb2luIiwicHVzaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/flatten.ts\n");

/***/ }),

/***/ "(rsc)/./lib/verifySignature.ts":
/*!********************************!*\
  !*** ./lib/verifySignature.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifySmartcarSignature: () => (/* binding */ verifySmartcarSignature)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction verifySmartcarSignature({ bodyBuffer, signatureHeader, secret }) {\n    if (!signatureHeader) return false;\n    const computed = node_crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac(\"sha256\", secret).update(bodyBuffer).digest(\"hex\");\n    // Header may contain just the hex digest\n    const provided = signatureHeader.trim();\n    if (computed.length !== provided.length) return false;\n    return node_crypto__WEBPACK_IMPORTED_MODULE_0___default().timingSafeEqual(Buffer.from(computed), Buffer.from(provided));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdmVyaWZ5U2lnbmF0dXJlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFnQztBQUV6QixTQUFTQyx3QkFBd0IsRUFDdENDLFVBQVUsRUFDVkMsZUFBZSxFQUNmQyxNQUFNLEVBS1A7SUFDQyxJQUFJLENBQUNELGlCQUFpQixPQUFPO0lBQzdCLE1BQU1FLFdBQVdMLDZEQUNKLENBQUMsVUFBVUksUUFDckJHLE1BQU0sQ0FBQ0wsWUFDUE0sTUFBTSxDQUFDO0lBRVYseUNBQXlDO0lBQ3pDLE1BQU1DLFdBQVdOLGdCQUFnQk8sSUFBSTtJQUNyQyxJQUFJTCxTQUFTTSxNQUFNLEtBQUtGLFNBQVNFLE1BQU0sRUFBRSxPQUFPO0lBQ2hELE9BQU9YLGtFQUFzQixDQUFDYSxPQUFPQyxJQUFJLENBQUNULFdBQVdRLE9BQU9DLElBQUksQ0FBQ0w7QUFDbkUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbWFydGNhci13ZWJob29rLWFwcC8uL2xpYi92ZXJpZnlTaWduYXR1cmUudHM/ZjE5MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3J5cHRvIGZyb20gJ25vZGU6Y3J5cHRvJ1xuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5U21hcnRjYXJTaWduYXR1cmUoe1xuICBib2R5QnVmZmVyLFxuICBzaWduYXR1cmVIZWFkZXIsXG4gIHNlY3JldCxcbn06IHtcbiAgYm9keUJ1ZmZlcjogQnVmZmVyXG4gIHNpZ25hdHVyZUhlYWRlcjogc3RyaW5nIHwgbnVsbFxuICBzZWNyZXQ6IHN0cmluZ1xufSkge1xuICBpZiAoIXNpZ25hdHVyZUhlYWRlcikgcmV0dXJuIGZhbHNlXG4gIGNvbnN0IGNvbXB1dGVkID0gY3J5cHRvXG4gICAgLmNyZWF0ZUhtYWMoJ3NoYTI1NicsIHNlY3JldClcbiAgICAudXBkYXRlKGJvZHlCdWZmZXIpXG4gICAgLmRpZ2VzdCgnaGV4JylcblxuICAvLyBIZWFkZXIgbWF5IGNvbnRhaW4ganVzdCB0aGUgaGV4IGRpZ2VzdFxuICBjb25zdCBwcm92aWRlZCA9IHNpZ25hdHVyZUhlYWRlci50cmltKClcbiAgaWYgKGNvbXB1dGVkLmxlbmd0aCAhPT0gcHJvdmlkZWQubGVuZ3RoKSByZXR1cm4gZmFsc2VcbiAgcmV0dXJuIGNyeXB0by50aW1pbmdTYWZlRXF1YWwoQnVmZmVyLmZyb20oY29tcHV0ZWQpLCBCdWZmZXIuZnJvbShwcm92aWRlZCkpXG59XG5cblxuIl0sIm5hbWVzIjpbImNyeXB0byIsInZlcmlmeVNtYXJ0Y2FyU2lnbmF0dXJlIiwiYm9keUJ1ZmZlciIsInNpZ25hdHVyZUhlYWRlciIsInNlY3JldCIsImNvbXB1dGVkIiwiY3JlYXRlSG1hYyIsInVwZGF0ZSIsImRpZ2VzdCIsInByb3ZpZGVkIiwidHJpbSIsImxlbmd0aCIsInRpbWluZ1NhZmVFcXVhbCIsIkJ1ZmZlciIsImZyb20iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/verifySignature.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/drizzle-orm","vendor-chunks/ws","vendor-chunks/postgres","vendor-chunks/@vercel","vendor-chunks/utf-8-validate","vendor-chunks/node-gyp-build","vendor-chunks/bufferutil"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmaurocarrio%2Fsmartcar%2Fsmartcar-webhook-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();